@*
    VehicleCard Component
    Display a vehicle in card or list format
    
    Usage:
    <VehicleCard 
        Vehicle="vehicle" 
        UserVehicle="userVehicle"
        DisplayMode="VehicleCard.Mode.Card"
        OnClick="() => NavigateToVehicle(vehicle.Id)" />
*@

@using BlazorApp2.Data.Models

@if (DisplayMode == Mode.Card)
{
    <div class="vehicle-card @(UserVehicle?.IsPrimary == true ? "primary" : "")" @onclick="HandleClick">
        <div class="vehicle-card-header">
            <span class="year-badge">@Vehicle.Year</span>
            <div class="vehicle-badges">
                @if (!string.IsNullOrEmpty(Vehicle.BodyClass))
                {
                    <span class="badge badge-light">@Vehicle.BodyClass</span>
                }
                @if (UserVehicle?.IsPrimary == true)
                {
                    <span class="badge badge-primary">Primary</span>
                }
            </div>
        </div>
        
        <div class="vehicle-image-placeholder">
            <svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" fill="currentColor" viewBox="0 0 16 16">
                <path d="M2.52 3.515A2.5 2.5 0 0 1 4.82 2h6.362c1 0 1.904.596 2.298 1.515l.792 1.848c.075.175.21.319.38.404.5.25.855.715.965 1.262l.335 1.679c.033.161.049.325.049.49v.413c0 .814-.39 1.543-1 1.997V13.5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1-.5-.5v-1.338c-1.292.048-2.745.088-4 .088s-2.708-.04-4-.088V13.5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1-.5-.5v-1.892c-.61-.454-1-1.183-1-1.997v-.413a2.5 2.5 0 0 1 .049-.49l.335-1.68c.11-.546.465-1.012.964-1.261a.807.807 0 0 0 .381-.404l.792-1.848ZM3 10a1 1 0 1 0 0-2 1 1 0 0 0 0 2Zm10 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2ZM6 8a1 1 0 0 0 0 2h4a1 1 0 1 0 0-2H6ZM2.906 5.189a.51.51 0 0 0 .497.731c.91-.073 3.35-.17 4.597-.17 1.247 0 3.688.097 4.597.17a.51.51 0 0 0 .497-.731l-.956-1.913A.5.5 0 0 0 11.691 3H4.309a.5.5 0 0 0-.447.276L2.906 5.19Z"/>
            </svg>
        </div>
        
        <div class="vehicle-card-body">
            <div class="vehicle-info">
                <h3 class="vehicle-name">@Vehicle.Make?.Name @Vehicle.Model</h3>
                @if (!string.IsNullOrEmpty(Vehicle.Series) || !string.IsNullOrEmpty(Vehicle.Trim))
                {
                    <p class="vehicle-trim">
                        @if (!string.IsNullOrEmpty(Vehicle.Series))
                        {
                            <span>@Vehicle.Series</span>
                        }
                        @if (!string.IsNullOrEmpty(Vehicle.Series) && !string.IsNullOrEmpty(Vehicle.Trim))
                        {
                            <span> Â· </span>
                        }
                        @if (!string.IsNullOrEmpty(Vehicle.Trim))
                        {
                            <span>@Vehicle.Trim</span>
                        }
                    </p>
                }
            </div>
            
            @if (!string.IsNullOrEmpty(Vehicle.Engine) || !string.IsNullOrEmpty(Vehicle.Drivetrain))
            {
                <div class="vehicle-specs">
                    @if (!string.IsNullOrEmpty(Vehicle.Engine))
                    {
                        <span class="spec-tag">@Vehicle.Engine</span>
                    }
                    @if (!string.IsNullOrEmpty(Vehicle.Drivetrain))
                    {
                        <span class="spec-tag">@Vehicle.Drivetrain</span>
                    }
                </div>
            }
        </div>
        
        @if (ShowFooter && (Vehicle.CurrentMiles.HasValue || !string.IsNullOrEmpty(Vehicle.Color)))
        {
            <div class="vehicle-card-footer">
                @if (Vehicle.CurrentMiles.HasValue)
                {
                    <div class="footer-stat">
                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M8 4a.5.5 0 0 1 .5.5V6a.5.5 0 0 1-1 0V4.5A.5.5 0 0 1 8 4zM3.732 5.732a.5.5 0 0 1 .707 0l.915.914a.5.5 0 1 1-.708.708l-.914-.915a.5.5 0 0 1 0-.707zM2 10a.5.5 0 0 1 .5-.5h1.586a.5.5 0 0 1 0 1H2.5A.5.5 0 0 1 2 10zm9.5 0a.5.5 0 0 1 .5-.5h1.5a.5.5 0 0 1 0 1H12a.5.5 0 0 1-.5-.5zm.754-4.246a.389.389 0 0 0-.527-.02L7.547 9.31a.91.91 0 1 0 1.302 1.258l3.434-4.297a.389.389 0 0 0-.029-.518z"/>
                            <path fill-rule="evenodd" d="M0 10a8 8 0 1 1 15.547 2.661c-.442 1.253-1.845 1.602-2.932 1.25C11.309 13.488 9.475 13 8 13c-1.474 0-3.31.488-4.615.911-1.087.352-2.49.003-2.932-1.25A7.988 7.988 0 0 1 0 10zm8-7a7 7 0 0 0-6.603 9.329c.203.575.923.876 1.68.63C4.397 12.533 6.358 12 8 12s3.604.532 4.923.96c.757.245 1.477-.056 1.68-.631A7 7 0 0 0 8 3z"/>
                        </svg>
                        <span>@Vehicle.CurrentMiles.Value.ToString("N0") mi</span>
                    </div>
                }
                @if (!string.IsNullOrEmpty(Vehicle.Color))
                {
                    <div class="footer-stat">
                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M12.433 10.07C14.133 10.585 16 11.15 16 8a8 8 0 1 0-8 8c1.996 0 1.826-1.504 1.649-3.08-.124-1.101-.252-2.237.351-2.92.465-.527 1.42-.237 2.433.07zM8 5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm4.5 3a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zM5 6.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm.5 6.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z"/>
                        </svg>
                        <span>@Vehicle.Color</span>
                    </div>
                }
            </div>
        }
        
        @if (ShowHoverIndicator)
        {
            <div class="card-hover-indicator">
                <span>View Details</span>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/>
                </svg>
            </div>
        }
    </div>
}
else
{
    @* List/Row Mode *@
    <div class="vehicle-row @(UserVehicle?.IsPrimary == true ? "primary" : "")" @onclick="HandleClick">
        <div class="vehicle-row-main-section">
            <div class="vehicle-row-header">
                <span class="vehicle-row-year">@Vehicle.Year</span>
                <span class="vehicle-row-name">@Vehicle.Make?.Name @Vehicle.Model</span>
                @if (!string.IsNullOrEmpty(Vehicle.Series))
                {
                    <span class="vehicle-row-series">@Vehicle.Series</span>
                }
                @if (!string.IsNullOrEmpty(Vehicle.Trim))
                {
                    <span class="vehicle-row-trim">@Vehicle.Trim</span>
                }
            </div>
            <div class="vehicle-row-specs">
                @if (!string.IsNullOrEmpty(Vehicle.BodyClass))
                {
                    <span class="spec-tag-sm">@Vehicle.BodyClass</span>
                }
                @if (!string.IsNullOrEmpty(Vehicle.Engine))
                {
                    <span class="spec-tag-sm">@Vehicle.Engine</span>
                }
                @if (!string.IsNullOrEmpty(Vehicle.Drivetrain))
                {
                    <span class="spec-tag-sm">@Vehicle.Drivetrain</span>
                }
                @if (Vehicle.CurrentMiles.HasValue)
                {
                    <span class="spec-tag-sm spec-tag-mileage">@Vehicle.CurrentMiles.Value.ToString("N0") mi</span>
                }
            </div>
        </div>
        <div class="vehicle-row-badges">
            @if (UserVehicle?.IsPrimary == true)
            {
                <span class="badge badge-primary badge-sm">Primary</span>
            }
        </div>
        <div class="vehicle-row-arrow">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/>
            </svg>
        </div>
    </div>
}

@code {
    [Parameter, EditorRequired] public Vehicle Vehicle { get; set; } = default!;
    [Parameter] public UserVehicle? UserVehicle { get; set; }
    [Parameter] public Mode DisplayMode { get; set; } = Mode.Card;
    [Parameter] public bool ShowFooter { get; set; } = true;
    [Parameter] public bool ShowHoverIndicator { get; set; } = true;
    [Parameter] public EventCallback OnClick { get; set; }

    private async Task HandleClick()
    {
        await OnClick.InvokeAsync();
    }

    public enum Mode
    {
        Card,
        List
    }
}

